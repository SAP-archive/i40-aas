dist: bionic
language: generic
git:
  depth: 1

if: branch = master #AND type = push

env:
  - SVC=adapter-registry
  - SVC=data-manager
  - SVC=endpoint-registry
  - SVC=https-endpoint-egress
  - SVC=https-endpoint-ingress
  - SVC=onboarding-skill
  - SVC=storage-adapter-mongodb
  - SVC=grpc-endpoint-ingress
  - SVC=grpc-endpoint-egress
  - SVC=initializer
  - SVC=endpoint-resolver

install:
  - make --version
  - docker --version
  - docker-compose --version
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - make build-$SVC
  - make push-$SVC
